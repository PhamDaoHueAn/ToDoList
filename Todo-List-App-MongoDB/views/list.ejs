<!DOCTYPE html>
<html>
<head>
    <title>Todo List</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="box" id="heading">
        <h1><%= listTitle %></h1>
    </div>

    <div class="box">
        <% listArray.forEach((item) => { %>
            <div class="item">
                <input type="checkbox" id="<%= item._id %>">
                <p class="task-text"><%= item.name %></p>
                <div class="item-buttons">
                    <button class="edit-btn" onclick="editItem('<%= item._id %>', '<%= item.name %>')">
                        ‚úèÔ∏è
                    </button>
                    <button class="delete-btn" onclick="deleteItem('<%= item._id %>')">
                        üóëÔ∏è
                    </button>
                </div>
            </div>
        <% }); %>

        <form class="item" action="/" method="post">
            <input type="text" name="newItem" id="newItemInput" placeholder="Th√™m vi·ªác c·∫ßn l√†m..." autocomplete="off">
            <button type="submit" class="add-btn">+</button>
        </form>
    </div>

    <!-- Modal cho ch·ª©c nƒÉng s·ª≠a -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2>S·ª≠a c√¥ng vi·ªác</h2>
            <form id="editForm" action="/edit" method="post">
                <input type="hidden" id="editItemId" name="itemId">
                <input type="text" id="editItemText" name="newName" autocomplete="off">
                <div class="modal-buttons">
                    <button type="submit">L∆∞u</button>
                    <button type="button" onclick="closeModal()">H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function editItem(id, text) {
            document.getElementById('editModal').style.display = 'block';
            document.getElementById('editItemId').value = id;
            document.getElementById('editItemText').value = text;
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        function deleteItem(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a c√¥ng vi·ªác n√†y?')) {
                fetch('/delete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ itemId: id })
                }).then(() => {
                    window.location.reload();
                });
            }
        }
    </script>
</body>
</html>